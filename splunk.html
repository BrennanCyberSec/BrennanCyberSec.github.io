<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Splunk + Wazuh Integration | Brennan Vigna</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0b0a10;
            --bg-secondary: #12111a;
            --bg-tertiary: #1a1825;
            --bg-card: #151320;
            --purple-primary: #bf5af2;
            --purple-dim: #9945c7;
            --purple-deep: #7b2fbe;
            --purple-glow: rgba(191, 90, 242, 0.12);
            --purple-accent: #d98aff;
            --violet: #8b5cf6;
            --cyan: #5ce0d8;
            --cyan-dim: #3fb8b1;
            --amber: #f0a500;
            --amber-dim: #c78800;
            --red: #ff4f6d;
            --red-dim: #cc3e57;
            --green: #34d399;
            --text-primary: #d0cde1;
            --text-secondary: #a09bb5;
            --text-dim: #6b6580;
            --border: #2a2640;
            --border-light: #352f50;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        html { scroll-behavior: smooth; }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'IBM Plex Mono', monospace;
            font-size: 14px;
            line-height: 1.75;
            min-height: 100vh;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 3px,
                rgba(191, 90, 242, 0.008) 3px,
                rgba(191, 90, 242, 0.008) 6px
            );
            pointer-events: none;
            z-index: 1000;
        }

        /* ===== NAVIGATION ===== */
        .nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 900;
            background: rgba(11, 10, 16, 0.92);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border);
            padding: 0 24px;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .nav-brand {
            font-family: 'Fira Code', monospace;
            font-weight: 700;
            font-size: 15px;
            color: var(--purple-primary);
            text-decoration: none;
            letter-spacing: 0.5px;
        }

        .nav-brand:hover { color: var(--purple-accent); }

        .nav-links {
            display: flex;
            gap: 28px;
            list-style: none;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 13px;
            font-weight: 500;
            letter-spacing: 0.5px;
            transition: color 0.2s;
        }

        .nav-links a:hover { color: var(--purple-primary); }

        .hamburger {
            display: none;
            flex-direction: column;
            gap: 5px;
            cursor: pointer;
            background: none;
            border: none;
            padding: 4px;
        }

        .hamburger span {
            display: block;
            width: 22px;
            height: 2px;
            background: var(--text-secondary);
            transition: all 0.3s;
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(5px, -5px);
        }

        /* ===== MAIN CONTAINER ===== */
        .container {
            max-width: 880px;
            margin: 0 auto;
            padding: 80px 24px 80px;
        }

        /* ===== PAGE HEADER ===== */
        .page-header {
            border: 1px solid var(--border-light);
            background: var(--bg-secondary);
            padding: 36px 32px;
            margin-bottom: 44px;
            position: relative;
            overflow: hidden;
        }

        .page-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--purple-deep), var(--purple-primary), var(--violet), var(--cyan));
        }

        .page-header .tag {
            font-family: 'Fira Code', monospace;
            color: var(--purple-dim);
            font-size: 11px;
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 10px;
        }

        .page-header h1 {
            font-family: 'Fira Code', monospace;
            color: var(--purple-primary);
            font-size: 28px;
            font-weight: 700;
            text-shadow: 0 0 30px var(--purple-glow);
            margin-bottom: 14px;
            line-height: 1.3;
        }

        .page-header .meta {
            color: var(--text-dim);
            font-size: 12px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px 24px;
        }

        .page-header .meta .val { color: var(--amber); }

        /* ===== OVERVIEW BOX ===== */
        .overview-box {
            border-left: 3px solid var(--cyan);
            background: rgba(92, 224, 216, 0.04);
            padding: 22px 26px;
            margin-bottom: 40px;
        }

        .overview-box h2 {
            color: var(--cyan);
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 12px;
            font-family: 'Fira Code', monospace;
        }

        .overview-box p {
            font-size: 13px;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .overview-box p:last-child { margin-bottom: 0; }

        /* ===== TOOL TAGS ===== */
        .tool-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 40px;
        }

        .tool-tag {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            color: var(--purple-accent);
            font-size: 11px;
            padding: 4px 12px;
            letter-spacing: 0.5px;
            font-family: 'Fira Code', monospace;
        }

        /* ===== SECTIONS ===== */
        .section {
            margin-bottom: 52px;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 14px;
            margin-bottom: 22px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }

        .section-num {
            font-family: 'Fira Code', monospace;
            color: var(--bg-primary);
            background: var(--purple-primary);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 700;
            flex-shrink: 0;
        }

        .section-header h2 {
            color: var(--purple-primary);
            font-size: 18px;
            font-weight: 600;
            font-family: 'Fira Code', monospace;
        }

        .section p {
            margin-bottom: 16px;
            font-size: 13px;
        }

        /* ===== SCREENSHOTS ===== */
        .screenshot {
            margin: 20px 0;
            border: 1px solid var(--border);
            background: var(--bg-secondary);
            overflow: hidden;
        }

        .screenshot img {
            width: 100%;
            display: block;
        }

        .screenshot .caption {
            padding: 10px 16px;
            font-size: 11.5px;
            color: var(--text-dim);
            border-top: 1px solid var(--border);
            font-style: italic;
            line-height: 1.6;
        }

        /* ===== CODE BLOCKS ===== */
        .code-block {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            margin: 16px 0;
            overflow-x: auto;
        }

        .code-header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: 8px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .code-header .lang {
            color: var(--amber);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Fira Code', monospace;
        }

        .code-header .location {
            color: var(--text-dim);
            font-size: 11px;
        }

        .code-block pre {
            padding: 16px;
            font-family: 'Fira Code', monospace;
            font-size: 12.5px;
            line-height: 1.8;
            color: var(--text-primary);
            white-space: pre;
            overflow-x: auto;
        }

        /* ===== ALERT BOXES ===== */
        .alert-box {
            border-left: 3px solid var(--amber);
            background: rgba(240, 165, 0, 0.04);
            padding: 16px 20px;
            margin: 16px 0;
        }

        .alert-box.info {
            border-left-color: var(--cyan);
            background: rgba(92, 224, 216, 0.04);
        }

        .alert-box.danger {
            border-left-color: var(--red);
            background: rgba(255, 79, 109, 0.04);
        }

        .alert-box .alert-title {
            font-weight: 700;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 6px;
            font-family: 'Fira Code', monospace;
        }

        .alert-box .alert-title.warn { color: var(--amber); }
        .alert-box .alert-title.tip { color: var(--cyan); }
        .alert-box .alert-title.err { color: var(--red); }

        .alert-box p {
            font-size: 12.5px;
            margin-bottom: 0;
        }

        /* ===== THREAT INTEL TABLE ===== */
        .intel-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            padding: 20px 24px;
            margin: 16px 0;
        }

        .intel-card h4 {
            color: var(--red);
            font-size: 14px;
            margin-bottom: 12px;
            font-family: 'Fira Code', monospace;
        }

        .intel-card .field {
            display: flex;
            gap: 12px;
            margin-bottom: 6px;
            font-size: 12.5px;
        }

        .intel-card .field .label {
            color: var(--text-dim);
            min-width: 130px;
            flex-shrink: 0;
        }

        .intel-card .field .value {
            color: var(--text-primary);
        }

        .intel-card .field .value.bad {
            color: var(--red);
            font-weight: 600;
        }

        /* ===== DIVIDER ===== */
        .divider {
            border: none;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--border-light), transparent);
            margin: 44px 0;
        }

        /* ===== TAKEAWAYS ===== */
        .takeaway-list {
            list-style: none;
            padding: 0;
        }

        .takeaway-list li {
            padding: 12px 0 12px 24px;
            position: relative;
            font-size: 13px;
            border-bottom: 1px solid var(--border);
        }

        .takeaway-list li:last-child { border-bottom: none; }

        .takeaway-list li::before {
            content: '\25B8';
            position: absolute;
            left: 0;
            color: var(--purple-primary);
            font-size: 14px;
        }

        .takeaway-list li strong {
            color: var(--purple-accent);
        }

        /* ===== INLINE CODE ===== */
        code {
            background: var(--bg-tertiary);
            padding: 2px 6px;
            color: var(--amber);
            font-family: 'Fira Code', monospace;
            font-size: 12px;
        }

        /* ===== FOOTER ===== */
        .lab-footer {
            text-align: center;
            color: var(--text-dim);
            font-size: 11px;
            padding-top: 32px;
            border-top: 1px solid var(--border);
        }

        .lab-footer .cursor {
            display: inline-block;
            width: 8px;
            height: 14px;
            background: var(--purple-primary);
            animation: blink 1s step-end infinite;
            margin-left: 4px;
            vertical-align: middle;
        }

        @keyframes blink { 50% { opacity: 0; } }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .nav-links { display: none; }

            .nav-links.open {
                display: flex;
                flex-direction: column;
                position: absolute;
                top: 56px;
                left: 0;
                right: 0;
                background: rgba(11, 10, 16, 0.97);
                backdrop-filter: blur(12px);
                border-bottom: 1px solid var(--border);
                padding: 16px 24px;
                gap: 16px;
            }

            .hamburger { display: flex; }

            .container { padding: 72px 16px 60px; }

            .page-header { padding: 24px 20px; }
            .page-header h1 { font-size: 20px; }
            .page-header .meta { flex-direction: column; gap: 4px; }

            .intel-card .field { flex-direction: column; gap: 2px; }
            .intel-card .field .label { min-width: auto; }
        }
    </style>
</head>
<body>

    <!-- Navigation -->
    <nav class="nav">
        <a href="index.html" class="nav-brand">BV // Brennan Vigna</a>
        <ul class="nav-links" id="navLinks">
            <li><a href="index.html">Home</a></li>
            <li><a href="labs.html">Labs</a></li>
            <li><a href="tools.html">Tools</a></li>
            <li><a href="resume.html">Resume</a></li>
            <li><a href="contact.html">Contact</a></li>
        </ul>
        <button class="hamburger" id="hamburger" aria-label="Toggle navigation menu">
            <span></span>
            <span></span>
            <span></span>
        </button>
    </nav>

    <div class="container">

        <!-- Page Header -->
        <div class="page-header">
            <div class="tag">SOC Automation Lab // Splunk Integration</div>
            <h1>Splunk + Wazuh Integration Lab</h1>
            <div class="meta">
                <span>Platform: <span class="val">Vultr Cloud + VMware Workstation Pro</span></span>
                <span>License: <span class="val">Splunk Enterprise Trial</span></span>
                <span>Status: <span class="val">Complete</span></span>
            </div>
        </div>

        <!-- Overview -->
        <div class="overview-box">
            <h2>// Overview</h2>
            <p>Deployed Splunk Enterprise on a dedicated Vultr cloud server and integrated it with my existing Wazuh SIEM. The goal was to build a multi-SIEM environment where Wazuh handles detection and alerting while Splunk serves as the central analytics and threat hunting platform.</p>
            <p>I set up an Ubuntu victim machine to generate attack traffic, simulated a brute force attack with Hydra, created custom detection rules, and performed threat hunting against real live SSH attacks hitting my infrastructure.</p>
        </div>

        <!-- Tool Tags -->
        <div class="tool-tags">
            <span class="tool-tag">Splunk Enterprise</span>
            <span class="tool-tag">Splunk Universal Forwarder</span>
            <span class="tool-tag">Wazuh SIEM</span>
            <span class="tool-tag">Hydra</span>
            <span class="tool-tag">AbuseIPDB</span>
            <span class="tool-tag">WHOIS</span>
            <span class="tool-tag">Ubuntu 22.04</span>
            <span class="tool-tag">Kali Linux</span>
        </div>

        <!-- ==================== SECTION 1 ==================== -->
        <div class="section">
            <div class="section-header">
                <div class="section-num">1</div>
                <h2>Installing Splunk</h2>
            </div>

            <p>After deploying a fresh Ubuntu 22.04 server on Vultr, I downloaded and installed Splunk Enterprise. Splunk Free is not a separate product. It is Splunk Enterprise that defaults to a free license when you do not apply a paid one. This gives 500MB per day of indexing, which is more than enough for my lab environment.</p>

            <div class="screenshot">
                <img src="images/splunk/image1.png" alt="Splunk install terminal output">
                <div class="caption">Terminal output showing a successful Splunk Enterprise installation on the Vultr server.</div>
            </div>

            <p>After logging in with the credentials I created during the install phase, the Splunk welcome dashboard loaded. I also installed the Splunk Universal Forwarder on my Windows 10 and Ubuntu virtual machines.</p>

            <div class="screenshot">
                <img src="images/splunk/image2.png" alt="Splunk welcome dashboard">
                <div class="caption">The Splunk Enterprise welcome dashboard after first login. This confirms the web UI is accessible and Splunk is running.</div>
            </div>
        </div>

        <hr class="divider">

        <!-- ==================== SECTION 2 ==================== -->
        <div class="section">
            <div class="section-header">
                <div class="section-num">2</div>
                <h2>Lab Environment Tuning</h2>
            </div>

            <p>Splunk Enterprise comes configured for production environments by default. Since this is a home lab, I tuned several settings to reduce resource usage and noise while keeping full functionality.</p>

            <div class="screenshot">
                <img src="images/splunk/image3.png" alt="Splunk alert threshold settings">
                <div class="caption">Adjusted alert threshold settings for lab use. In production these would stay at their defaults.</div>
            </div>

            <p>Before editing config files, I switched to the splunk user to ensure proper file ownership.</p>

            <div class="screenshot">
                <img src="images/splunk/image4.png" alt="Switching to splunk user">
                <div class="caption">Switching to the splunk user before making configuration changes.</div>
            </div>

            <h3 style="color: var(--purple-accent); font-size: 15px; margin: 24px 0 12px;">limits.conf</h3>

            <p>I edited the limits.conf file to adjust disk usage, I/O wait, and search scheduler settings for a small lab system.</p>

            <div class="screenshot">
                <img src="images/splunk/image5.png" alt="limits.conf command">
                <div class="caption">Running the command to edit the limits.conf file.</div>
            </div>

            <div class="screenshot">
                <img src="images/splunk/image6.png" alt="limits.conf contents">
                <div class="caption">The limits.conf settings: max_disk_usage set to 95%, min_free_space at 500MB, max_iowait at 50, and max_searches_perc at 50. These prevent Splunk from consuming too many resources on a small server.</div>
            </div>

            <h3 style="color: var(--purple-accent); font-size: 15px; margin: 24px 0 12px;">log.cfg</h3>

            <p>Splunk naturally creates a lot of noisy internal logs. For this home lab I reduced the logging level so Splunk only logs warnings and errors instead of every minor detail.</p>

            <div class="screenshot">
                <img src="images/splunk/image7.png" alt="log.cfg command">
                <div class="caption">Running the command to edit the log.cfg file.</div>
            </div>

            <div class="screenshot">
                <img src="images/splunk/image8.png" alt="log.cfg contents">
                <div class="caption">Set category.Root.level to WARN and category.Metrics.level to ERROR. This cuts down on internal log noise significantly without losing important error information.</div>
            </div>

            <h3 style="color: var(--purple-accent); font-size: 15px; margin: 24px 0 12px;">indexes.conf</h3>

            <p>Finally I capped the amount of disk space Splunk's internal telemetry logs are allowed to use and set them to automatically delete after 7 days.</p>

            <div class="screenshot">
                <img src="images/splunk/image9.png" alt="indexes.conf command">
                <div class="caption">Running the command to edit the indexes.conf file for internal log settings.</div>
            </div>

            <div class="screenshot">
                <img src="images/splunk/image10.png" alt="indexes.conf internal settings">
                <div class="caption">The _internal index capped at maxTotalDataSizeMB of 500 and frozenTimePeriodInSecs of 604800 which is 7 days. This prevents Splunk's own logs from eating up disk space over time.</div>
            </div>
        </div>

        <hr class="divider">

        <!-- ==================== SECTION 3 ==================== -->
        <div class="section">
            <div class="section-header">
                <div class="section-num">3</div>
                <h2>Verifying Ports and Connectivity</h2>
            </div>

            <p>Before sending any logs I did a sanity check to confirm Splunk was listening on the correct ports.</p>

            <div class="screenshot">
                <img src="images/splunk/image11.png" alt="Port verification">
                <div class="caption">Output of ss -lntp showing Splunk is listening on the expected ports: 8000 for web UI, 8089 for management, and 9997 for forwarder receiving.</div>
            </div>

            <p>Next I tested network connectivity from the Ubuntu victim machine to the Splunk server using netcat. The -z flag means zero I/O mode which just tests the connection without sending data. The -v flag is verbose mode so it tells us whether the connection succeeded or failed.</p>

            <div class="screenshot">
                <img src="images/splunk/image12.png" alt="Netcat connection test">
                <div class="caption">Netcat test from the Ubuntu victim to the Splunk server on port 8000 showing a successful connection. This confirms the victim machine can communicate with Splunk over the network.</div>
            </div>
        </div>

        <hr class="divider">

        <!-- ==================== SECTION 4 ==================== -->
        <div class="section">
            <div class="section-header">
                <div class="section-num">4</div>
                <h2>Sending Ubuntu Logs to Splunk</h2>
            </div>

            <p>Instead of doing most of the configuration through the GUI, I focused on using config files directly. This is a foundational skill. In enterprise environments Splunk deployments are managed through config files pushed via deployment servers, not through clicking around in the web UI.</p>

            <div class="screenshot">
                <img src="images/splunk/image13.png" alt="outputs.conf and inputs.conf">
                <div class="caption">The outputs.conf points to the Splunk server on port 9997. The inputs.conf monitors /var/log/auth.log and sends events to the linux index with sourcetype linux_secure.</div>
            </div>

            <p>After restarting Splunk on both instances, I checked if Splunk was collecting logs from the Ubuntu machine.</p>

            <div class="screenshot">
                <img src="images/splunk/image14.png" alt="First logs in Splunk">
                <div class="caption">Searching index=linux in Splunk and seeing logs from the Ubuntu victim machine. The forwarder pipeline is working.</div>
            </div>
        </div>

        <hr class="divider">

        <!-- ==================== SECTION 5 ==================== -->
        <div class="section">
            <div class="section-header">
                <div class="section-num">5</div>
                <h2>SSH Setup and Baseline Testing</h2>
            </div>

            <p>To generate meaningful security logs, I installed and enabled OpenSSH on the Ubuntu victim machine.</p>

            <div class="screenshot">
                <img src="images/splunk/image15.png" alt="Installing OpenSSH">
                <div class="caption">Installing openssh-server on the Ubuntu victim machine.</div>
            </div>

            <div class="screenshot">
                <img src="images/splunk/image16.png" alt="Enabling OpenSSH">
                <div class="caption">Enabling and verifying the SSH service. The ss -lntp output confirms SSH is listening on port 22. The flags: -l for listening ports, -n to show IPs without resolving, -t for TCP only, -p to show the process ID.</div>
            </div>

            <p>I connected via SSH from my Kali attacker machine into the Ubuntu victim to generate a legitimate login event, then checked Splunk to see if it captured the activity.</p>

            <div class="screenshot">
                <img src="images/splunk/image17.png" alt="SSH login from Kali">
                <div class="caption">Successful SSH connection from Kali to the Ubuntu victim machine.</div>
            </div>

            <div class="screenshot">
                <img src="images/splunk/image18.png" alt="SSH event in Splunk">
                <div class="caption">The SSH login event captured in Splunk. The query filters for SSH-related events in the linux index.</div>
            </div>

            <div class="screenshot">
                <img src="images/splunk/image19.png" alt="SSH event details">
                <div class="caption">Detailed view of the SSH login event showing the source IP, user, and authentication method. The legitimate login from Kali was successfully forwarded to Splunk.</div>
            </div>
        </div>

        <hr class="divider">

        <!-- ==================== SECTION 6 ==================== -->
        <div class="section">
            <div class="section-header">
                <div class="section-num">6</div>
                <h2>Simulated Brute Force Attack</h2>
            </div>

            <p>I launched a brute force attack from my Kali machine against the Ubuntu victim using Hydra, a common brute force tool, with the rockyou.txt wordlist. I set a 3-second delay between attempts because OpenSSH grows suspicious if you are spamming multiple passwords per second.</p>

            <div class="screenshot">
                <img src="images/splunk/image20.png" alt="Hydra brute force attack">
                <div class="caption">Hydra running a brute force attack against the Ubuntu victim's SSH service using rockyou.txt. Each attempt uses a different password from the wordlist.</div>
            </div>

            <p>The attack generated a flood of failed authentication events that were immediately visible in Splunk. The source IP stays the same but the source port changes with each attempt. Hydra opens a new connection for every password guess.</p>

            <div class="screenshot">
                <img src="images/splunk/image21.png" alt="Brute force events in Splunk">
                <div class="caption">Failed password attempts from the Kali attacker IP showing up in Splunk. Notice the source IP stays the same but the source port changes with each attempt.</div>
            </div>

            <h3 style="color: var(--purple-accent); font-size: 15px; margin: 24px 0 12px;">Custom Detection Rule</h3>

            <p>I created a custom Splunk alert rule to detect SSH brute force attacks. The rule triggered over 160 alerts from the Hydra attack and clearly identified the attacker's IP.</p>

            <div class="screenshot">
                <img src="images/splunk/image22.png" alt="Custom brute force alert results">
                <div class="caption">The custom brute force detection rule showing 160+ alerts and the attacker's Kali IP.</div>
            </div>

            <div class="screenshot">
                <img src="images/splunk/image23.png" alt="Alert rule configuration">
                <div class="caption">Configuration details of the custom brute force alert rule showing the SPL query and trigger conditions.</div>
            </div>

            <h3 style="color: var(--purple-accent); font-size: 15px; margin: 24px 0 12px;">Email Alerting</h3>

            <p>I also configured email alerting so I get notified whenever the brute force rule fires.</p>

            <div class="screenshot">
                <img src="images/splunk/image24.png" alt="Email alert configuration">
                <div class="caption">Email alert configuration in Splunk. When the brute force detection rule triggers, an email notification is sent automatically.</div>
            </div>
        </div>

        <hr class="divider">

        <!-- ==================== SECTION 7 ==================== -->
        <div class="section">
            <div class="section-header">
                <div class="section-num">7</div>
                <h2>Wazuh to Splunk Integration</h2>
            </div>

            <p>With Splunk receiving logs from the Ubuntu victim, the next step was to connect my Wazuh SIEM to Splunk. Wazuh is a detection engine that generates alerts based on rules. Splunk is a search and analytics platform that lets you hunt, correlate, build dashboards, and investigate across multiple data sources in one place. Having both connected shows how enterprise security stacks are layered.</p>

            <p>I added a wazuh-alerts index to the Splunk server's indexes.conf to store the incoming Wazuh alerts.</p>

            <div class="screenshot">
                <img src="images/splunk/image25.png" alt="wazuh-alerts index in indexes.conf">
                <div class="caption">The wazuh-alerts index configuration added to indexes.conf on the Splunk server.</div>
            </div>

            <div class="screenshot">
                <img src="images/splunk/image26.png" alt="inputs.conf with receiving port">
                <div class="caption">The inputs.conf file on the Splunk server with the splunktcp://9997 listener enabled and the wazuh-related configurations.</div>
            </div>

            <p>I installed the Splunk Universal Forwarder directly on my Wazuh server and configured it to monitor Wazuh's alerts.json file. This is the file where Wazuh writes all of its alerts in JSON format. The key config files on the Wazuh server's forwarder:</p>

            <div class="alert-box info">
                <div class="alert-title tip">Forwarder Config Files</div>
                <p><strong>inputs.conf</strong> &mdash; monitors /var/ossec/logs/alerts/alerts.json, sends to the wazuh-alerts index with sourcetype wazuh-alerts</p>
                <p style="margin-top: 6px;"><strong>outputs.conf</strong> &mdash; forwards to the Splunk server on port 9997</p>
                <p style="margin-top: 6px;"><strong>props.conf</strong> &mdash; tells Splunk to parse the incoming data as JSON with INDEXED_EXTRACTIONS set to json. This was the missing piece that took extra troubleshooting to figure out.</p>
            </div>

            <p>After letting it run overnight, Wazuh alerts started flowing into Splunk. And what I found was way more interesting than anything I simulated.</p>

            <div class="screenshot">
                <img src="images/splunk/image27.png" alt="Wazuh alerts in Splunk">
                <div class="caption">Over 41,000 real Wazuh alerts now visible in Splunk by searching index="wazuh-alerts". These are real SSH brute force attempts from bots on the internet targeting my Wazuh server's public IP.</div>
            </div>
        </div>

        <hr class="divider">

        <!-- ==================== SECTION 8 ==================== -->
        <div class="section">
            <div class="section-header">
                <div class="section-num">8</div>
                <h2>Threat Hunting with Real Attack Data</h2>
            </div>

            <p>The data flowing from Wazuh into Splunk was not from my lab attacks. It was from real malicious infrastructure on the internet constantly scanning and brute forcing my Vultr server's SSH service. This gave me an opportunity to do genuine threat hunting with live data.</p>

            <p>The flow: someone on the internet tries to SSH into my Wazuh server, Wazuh detects it and generates an alert, the Splunk forwarder reads that alert from alerts.json, sends it to Splunk, and then I can search, analyze, and hunt.</p>

            <h3 style="color: var(--purple-accent); font-size: 15px; margin: 24px 0 12px;">Top Usernames Attempted</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="lang">SPL</span>
                    <span class="location">Splunk Search</span>
                </div>
                <pre>index="wazuh-alerts" rule.id=5710 | stats count by data.srcuser | sort -count</pre>
            </div>

            <div class="screenshot">
                <img src="images/splunk/image28.png" alt="Top usernames">
                <div class="caption">The top attempted usernames: ubuntu at 2,046 attempts, admin at 1,742, user at 1,538, sol at 1,042, solana at 828, debian at 824, and more. These are all common default Linux usernames that automated tools cycle through.</div>
            </div>

            <h3 style="color: var(--purple-accent); font-size: 15px; margin: 24px 0 12px;">Checking for Successful Logins</h3>

            <p>The most critical check: did any of these brute force attempts actually succeed?</p>

            <div class="code-block">
                <div class="code-header">
                    <span class="lang">SPL</span>
                    <span class="location">Splunk Search</span>
                </div>
                <pre>index="wazuh-alerts" rule.groups{}="authentication_success" | stats count by data.srcip, data.srcuser</pre>
            </div>

            <div class="screenshot">
                <img src="images/splunk/image29.png" alt="No successful logins">
                <div class="caption">Zero successful authentications from unknown external sources. Nobody got in. The server's authentication controls are holding.</div>
            </div>

            <h3 style="color: var(--purple-accent); font-size: 15px; margin: 24px 0 12px;">Threat Intelligence Enrichment</h3>

            <p>I took the top attacking IP addresses and ran them through AbuseIPDB and WHOIS to enrich the data with threat intelligence context.</p>

            <div class="intel-card">
                <h4>165.245.128.147 &mdash; Top Attacker</h4>
                <div class="field"><span class="label">ISP</span><span class="value">DigitalOcean, LLC</span></div>
                <div class="field"><span class="label">Location</span><span class="value">Douglasville, Georgia, USA</span></div>
                <div class="field"><span class="label">Usage Type</span><span class="value">Data Center / Web Hosting</span></div>
                <div class="field"><span class="label">AbuseIPDB</span><span class="value bad">Reported 104 times, 100% Confidence of Abuse</span></div>
                <div class="field"><span class="label">Assessment</span><span class="value">Likely a compromised DigitalOcean droplet being used as part of a botnet</span></div>
            </div>

            <div class="intel-card">
                <h4>80.94.92.* Cluster &mdash; Coordinated Attack Infrastructure</h4>
                <div class="field"><span class="label">ISP</span><span class="value">TECHOFF SRV LIMITED</span></div>
                <div class="field"><span class="label">Location</span><span class="value">Timisoara, Romania</span></div>
                <div class="field"><span class="label">Domain</span><span class="value">dmzhost.co</span></div>
                <div class="field"><span class="label">AbuseIPDB</span><span class="value bad">Reported 41,623 times, 100% Confidence of Abuse</span></div>
                <div class="field"><span class="label">Assessment</span><span class="value">Known bulletproof hosting provider. Multiple IPs in the same /24 subnet attacking simultaneously. This is coordinated botnet infrastructure purpose-built for attacks, not a compromised server.</span></div>
            </div>

            <p>Both are data center IPs, not residential. No legitimate user would be SSHing into a Wazuh server from a Romanian hosting provider. This is textbook automated credential stuffing.</p>
        </div>

        <hr class="divider">

        <!-- ==================== KEY TAKEAWAYS ==================== -->
        <div class="section">
            <div class="section-header">
                <div class="section-num">&#10003;</div>
                <h2>Key Takeaways</h2>
            </div>

            <ul class="takeaway-list">
                <li><strong>Config files over GUI:</strong> I focused on managing Splunk through config files like outputs.conf, inputs.conf, props.conf, and indexes.conf rather than the GUI. In enterprise environments Splunk deployments are managed through config files pushed via deployment servers.</li>
                <li><strong>Real troubleshooting:</strong> Getting Wazuh connected to Splunk required working through multiple issues including privileged port restrictions, index path collisions, forwarder connectivity problems, and missing JSON parsing configs. Each problem taught me something practical about how these tools work under the hood.</li>
                <li><strong>Real attack data is better than simulated:</strong> The 41,000+ real brute force attempts from the internet provided far richer threat hunting material than anything I could have simulated in a closed lab.</li>
                <li><strong>Complete SOC workflow:</strong> This lab walked through a full Tier 1/2 SOC analyst workflow: alert triage in Splunk, pattern analysis with SPL queries, threat intelligence enrichment via AbuseIPDB and WHOIS, confirming malicious intent, and documenting findings.</li>
            </ul>
        </div>

        <!-- Footer -->
        <div class="lab-footer">
            <p>Brennan Vigna // SOC Automation Lab &mdash; Splunk + Wazuh Integration<span class="cursor"></span></p>
        </div>

    </div>

    <script>
        const hamburger = document.getElementById('hamburger');
        const navLinks = document.getElementById('navLinks');

        hamburger.addEventListener('click', function() {
            this.classList.toggle('active');
            navLinks.classList.toggle('open');
        });

        // Close menu when a link is clicked
        document.querySelectorAll('.nav-links a').forEach(function(link) {
            link.addEventListener('click', function() {
                hamburger.classList.remove('active');
                navLinks.classList.remove('open');
            });
        });

        // Close menu when clicking outside
        document.addEventListener('click', function(e) {
            if (!hamburger.contains(e.target) && !navLinks.contains(e.target)) {
                hamburger.classList.remove('active');
                navLinks.classList.remove('open');
            }
        });
    </script>

</body>
</html>
